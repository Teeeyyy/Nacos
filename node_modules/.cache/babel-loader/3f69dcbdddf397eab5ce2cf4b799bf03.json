{"ast":null,"code":"import algosdk from \"algosdk\";\nconst port = \"\";\nconst CHOICE_ID = 21364625;\nconst baseServer = \"https://testnet-algorand.api.purestake.io/ps2\";\nconst indexerAddress = \"https://testnet-algorand.api.purestake.io/idx2\";\nconst token = {\n  \"X-API-Key\": \"fi0QdbiBVl8hsVMCA2SUg6jnQdvAzxY48Zy2G6Yc\"\n};\nconst algodClient = new algosdk.Algodv2(token, baseServer, port);\nconst indexerClient = new algosdk.Indexer(token, indexerAddress, port);\n\nconst getTotal = async () => {\n  try {\n    let obj_array = [];\n    let voter_address = \"S76LPUPTSGL56BUGRKEQSWEDQ6VSMP62FPE3XJDREJ2XIDWQC36DL2KDJQ\";\n    let history = await indexerClient.searchForTransactions().address(voter_address).assetID(CHOICE_ID).limit(20).do();\n    const transactions_history = history[\"transactions\"]; //loop to check if the receiver was red_address or blue address\n\n    transactions_history.forEach(element => {\n      const transaction = element[\"asset-transfer-transaction\"];\n\n      if (transaction[\"receiver\"] == red_address) {\n        obj = {\n          candidate: \"Red\",\n          address: red_address,\n          Id: element[\"id\"],\n          amount: transaction[\"amount\"] / 100\n        };\n        obj_array.push(obj);\n      } else if (transaction[\"receiver\"] == blue_address) {\n        obj = {\n          candidate: \"Blue\",\n          address: blue_address,\n          Id: element[\"id\"],\n          amount: transaction[\"amount\"] / 100\n        };\n        obj_array.push(obj);\n      }\n    });\n    console.log(obj_array);\n  } catch (error) {\n    console.log(error);\n  }\n};\n\nconst getCommittedAmount = async () => {\n  const history = await indexerClient.searchForTransactions().address(\"S76LPUPTSGL56BUGRKEQSWEDQ6VSMP62FPE3XJDREJ2XIDWQC36DL2KDJQ\").assetID(CHOICE_ID).limit(20).do();\n  const txn = history[\"transactions\"];\n  return txn;\n};\n\nexport { getCommittedAmount };","map":{"version":3,"sources":["C:/Users/Williams/Desktop/App/choice-voting-app/frontend/src/getCommittedAmount.js"],"names":["algosdk","port","CHOICE_ID","baseServer","indexerAddress","token","algodClient","Algodv2","indexerClient","Indexer","getTotal","obj_array","voter_address","history","searchForTransactions","address","assetID","limit","do","transactions_history","forEach","element","transaction","red_address","obj","candidate","Id","amount","push","blue_address","console","log","error","getCommittedAmount","txn"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AAEA,MAAMC,IAAI,GAAG,EAAb;AACA,MAAMC,SAAS,GAAG,QAAlB;AACA,MAAMC,UAAU,GAAG,+CAAnB;AACA,MAAMC,cAAc,GAAG,gDAAvB;AACA,MAAMC,KAAK,GAAG;AAAE,eAAa;AAAf,CAAd;AAEA,MAAMC,WAAW,GAAG,IAAIN,OAAO,CAACO,OAAZ,CAAoBF,KAApB,EAA2BF,UAA3B,EAAuCF,IAAvC,CAApB;AAEA,MAAMO,aAAa,GAAG,IAAIR,OAAO,CAACS,OAAZ,CAAoBJ,KAApB,EAA2BD,cAA3B,EAA2CH,IAA3C,CAAtB;;AAEA,MAAMS,QAAQ,GAAG,YAAY;AAC3B,MAAI;AACF,QAAIC,SAAS,GAAG,EAAhB;AACA,QAAIC,aAAa,GACf,4DADF;AAEA,QAAIC,OAAO,GAAG,MAAML,aAAa,CAC9BM,qBADiB,GAEjBC,OAFiB,CAETH,aAFS,EAGjBI,OAHiB,CAGTd,SAHS,EAIjBe,KAJiB,CAIX,EAJW,EAKjBC,EALiB,EAApB;AAMA,UAAMC,oBAAoB,GAAGN,OAAO,CAAC,cAAD,CAApC,CAVE,CAWF;;AACAM,IAAAA,oBAAoB,CAACC,OAArB,CAA8BC,OAAD,IAAa;AACxC,YAAMC,WAAW,GAAGD,OAAO,CAAC,4BAAD,CAA3B;;AACA,UAAIC,WAAW,CAAC,UAAD,CAAX,IAA2BC,WAA/B,EAA4C;AAC1CC,QAAAA,GAAG,GAAG;AACJC,UAAAA,SAAS,EAAE,KADP;AAEJV,UAAAA,OAAO,EAAEQ,WAFL;AAGJG,UAAAA,EAAE,EAAEL,OAAO,CAAC,IAAD,CAHP;AAIJM,UAAAA,MAAM,EAAEL,WAAW,CAAC,QAAD,CAAX,GAAwB;AAJ5B,SAAN;AAMAX,QAAAA,SAAS,CAACiB,IAAV,CAAeJ,GAAf;AACD,OARD,MAQO,IAAIF,WAAW,CAAC,UAAD,CAAX,IAA2BO,YAA/B,EAA6C;AAClDL,QAAAA,GAAG,GAAG;AACJC,UAAAA,SAAS,EAAE,MADP;AAEJV,UAAAA,OAAO,EAAEc,YAFL;AAGJH,UAAAA,EAAE,EAAEL,OAAO,CAAC,IAAD,CAHP;AAIJM,UAAAA,MAAM,EAAEL,WAAW,CAAC,QAAD,CAAX,GAAwB;AAJ5B,SAAN;AAMAX,QAAAA,SAAS,CAACiB,IAAV,CAAeJ,GAAf;AACD;AACF,KAnBD;AAoBAM,IAAAA,OAAO,CAACC,GAAR,CAAYpB,SAAZ;AACD,GAjCD,CAiCE,OAAOqB,KAAP,EAAc;AACdF,IAAAA,OAAO,CAACC,GAAR,CAAYC,KAAZ;AACD;AACF,CArCD;;AAuCA,MAAMC,kBAAkB,GAAG,YAAY;AACrC,QAAMpB,OAAO,GAAG,MAAML,aAAa,CAChCM,qBADmB,GAEnBC,OAFmB,CAEX,4DAFW,EAGnBC,OAHmB,CAGXd,SAHW,EAInBe,KAJmB,CAIb,EAJa,EAKnBC,EALmB,EAAtB;AAOA,QAAMgB,GAAG,GAAGrB,OAAO,CAAC,cAAD,CAAnB;AAEA,SAAOqB,GAAP;AACD,CAXD;;AAaA,SAASD,kBAAT","sourcesContent":["import algosdk from \"algosdk\";\r\n\r\nconst port = \"\";\r\nconst CHOICE_ID = 21364625;\r\nconst baseServer = \"https://testnet-algorand.api.purestake.io/ps2\";\r\nconst indexerAddress = \"https://testnet-algorand.api.purestake.io/idx2\";\r\nconst token = { \"X-API-Key\": \"fi0QdbiBVl8hsVMCA2SUg6jnQdvAzxY48Zy2G6Yc\" };\r\n\r\nconst algodClient = new algosdk.Algodv2(token, baseServer, port);\r\n\r\nconst indexerClient = new algosdk.Indexer(token, indexerAddress, port);\r\n\r\nconst getTotal = async () => {\r\n  try {\r\n    let obj_array = [];\r\n    let voter_address =\r\n      \"S76LPUPTSGL56BUGRKEQSWEDQ6VSMP62FPE3XJDREJ2XIDWQC36DL2KDJQ\";\r\n    let history = await indexerClient\r\n      .searchForTransactions()\r\n      .address(voter_address)\r\n      .assetID(CHOICE_ID)\r\n      .limit(20)\r\n      .do();\r\n    const transactions_history = history[\"transactions\"];\r\n    //loop to check if the receiver was red_address or blue address\r\n    transactions_history.forEach((element) => {\r\n      const transaction = element[\"asset-transfer-transaction\"];\r\n      if (transaction[\"receiver\"] == red_address) {\r\n        obj = {\r\n          candidate: \"Red\",\r\n          address: red_address,\r\n          Id: element[\"id\"],\r\n          amount: transaction[\"amount\"] / 100,\r\n        };\r\n        obj_array.push(obj);\r\n      } else if (transaction[\"receiver\"] == blue_address) {\r\n        obj = {\r\n          candidate: \"Blue\",\r\n          address: blue_address,\r\n          Id: element[\"id\"],\r\n          amount: transaction[\"amount\"] / 100,\r\n        };\r\n        obj_array.push(obj);\r\n      }\r\n    });\r\n    console.log(obj_array);\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n};\r\n\r\nconst getCommittedAmount = async () => {\r\n  const history = await indexerClient\r\n    .searchForTransactions()\r\n    .address(\"S76LPUPTSGL56BUGRKEQSWEDQ6VSMP62FPE3XJDREJ2XIDWQC36DL2KDJQ\")\r\n    .assetID(CHOICE_ID)\r\n    .limit(20)\r\n    .do();\r\n\r\n  const txn = history[\"transactions\"];\r\n\r\n  return txn;\r\n};\r\n\r\nexport { getCommittedAmount };\r\n"]},"metadata":{},"sourceType":"module"}