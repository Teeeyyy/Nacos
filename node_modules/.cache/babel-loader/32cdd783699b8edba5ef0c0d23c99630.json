{"ast":null,"code":"import algosdk from \"algosdk\";\nconst port = \"\";\nconst CHOICE_ID = 21364625;\nconst baseServer = \"https://testnet-algorand.api.purestake.io/ps2\";\nconst indexerAddress = \"https://testnet-algorand.api.purestake.io/idx2\";\nconst token = {\n  \"X-API-Key\": \"fi0QdbiBVl8hsVMCA2SUg6jnQdvAzxY48Zy2G6Yc\"\n};\nconst algodClient = new algosdk.Algodv2(token, baseServer, port);\nconst indexerClient = new algosdk.Indexer(token, indexerAddress, port);\n\nconst getCommittedAmount = async ({\n  options\n}) => {\n  const firstAddress = options[0].address;\n  const secondAddress = options[1].address;\n\n  try {\n    let txnArray = [];\n    let userAddress = \"S76LPUPTSGL56BUGRKEQSWEDQ6VSMP62FPE3XJDREJ2XIDWQC36DL2KDJQ\";\n    let pastTxn = await indexerClient.searchForTransactions().address(userAddress).assetID(CHOICE_ID).limit(20).do();\n    const txns = pastTxn[\"transactions\"];\n    txns.forEach(element => {\n      let obj = {};\n      const txn = element[\"asset-transfer-transaction\"];\n\n      if (txn[\"receiver\"] == firstAddress) {\n        obj = {\n          candidate: options[0].name,\n          address: firstAddress,\n          Id: element[\"id\"],\n          amount: txn[\"amount\"] / 100\n        };\n        txnArray.push(obj);\n      } else if (txn[\"receiver\"] == secondAddress) {\n        obj = {\n          Id: element[\"id\"],\n          address: secondAddress,\n          candidate: options[0].name,\n          amount: txn[\"amount\"] / 100\n        };\n        txnArray.push(obj);\n      }\n    });\n    console.log(txnArray);\n  } catch (error) {\n    console.log(error);\n  }\n\n  return \"good\";\n};\n\nexport { getCommittedAmount };","map":{"version":3,"sources":["C:/Users/Williams/Desktop/App/choice-voting-app/frontend/src/getCommittedAmount.js"],"names":["algosdk","port","CHOICE_ID","baseServer","indexerAddress","token","algodClient","Algodv2","indexerClient","Indexer","getCommittedAmount","options","firstAddress","address","secondAddress","txnArray","userAddress","pastTxn","searchForTransactions","assetID","limit","do","txns","forEach","element","obj","txn","candidate","name","Id","amount","push","console","log","error"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AAEA,MAAMC,IAAI,GAAG,EAAb;AACA,MAAMC,SAAS,GAAG,QAAlB;AACA,MAAMC,UAAU,GAAG,+CAAnB;AACA,MAAMC,cAAc,GAAG,gDAAvB;AACA,MAAMC,KAAK,GAAG;AAAE,eAAa;AAAf,CAAd;AAEA,MAAMC,WAAW,GAAG,IAAIN,OAAO,CAACO,OAAZ,CAAoBF,KAApB,EAA2BF,UAA3B,EAAuCF,IAAvC,CAApB;AAEA,MAAMO,aAAa,GAAG,IAAIR,OAAO,CAACS,OAAZ,CAAoBJ,KAApB,EAA2BD,cAA3B,EAA2CH,IAA3C,CAAtB;;AAEA,MAAMS,kBAAkB,GAAG,OAAO;AAAEC,EAAAA;AAAF,CAAP,KAAuB;AAChD,QAAMC,YAAY,GAAGD,OAAO,CAAC,CAAD,CAAP,CAAWE,OAAhC;AACA,QAAMC,aAAa,GAAGH,OAAO,CAAC,CAAD,CAAP,CAAWE,OAAjC;;AAEA,MAAI;AACF,QAAIE,QAAQ,GAAG,EAAf;AACA,QAAIC,WAAW,GACb,4DADF;AAEA,QAAIC,OAAO,GAAG,MAAMT,aAAa,CAC9BU,qBADiB,GAEjBL,OAFiB,CAETG,WAFS,EAGjBG,OAHiB,CAGTjB,SAHS,EAIjBkB,KAJiB,CAIX,EAJW,EAKjBC,EALiB,EAApB;AAOA,UAAMC,IAAI,GAAGL,OAAO,CAAC,cAAD,CAApB;AAEAK,IAAAA,IAAI,CAACC,OAAL,CAAcC,OAAD,IAAa;AACxB,UAAIC,GAAG,GAAG,EAAV;AACA,YAAMC,GAAG,GAAGF,OAAO,CAAC,4BAAD,CAAnB;;AAEA,UAAIE,GAAG,CAAC,UAAD,CAAH,IAAmBd,YAAvB,EAAqC;AACnCa,QAAAA,GAAG,GAAG;AACJE,UAAAA,SAAS,EAAEhB,OAAO,CAAC,CAAD,CAAP,CAAWiB,IADlB;AAEJf,UAAAA,OAAO,EAAED,YAFL;AAGJiB,UAAAA,EAAE,EAAEL,OAAO,CAAC,IAAD,CAHP;AAIJM,UAAAA,MAAM,EAAEJ,GAAG,CAAC,QAAD,CAAH,GAAgB;AAJpB,SAAN;AAOAX,QAAAA,QAAQ,CAACgB,IAAT,CAAcN,GAAd;AACD,OATD,MASO,IAAIC,GAAG,CAAC,UAAD,CAAH,IAAmBZ,aAAvB,EAAsC;AAC3CW,QAAAA,GAAG,GAAG;AACJI,UAAAA,EAAE,EAAEL,OAAO,CAAC,IAAD,CADP;AAEJX,UAAAA,OAAO,EAAEC,aAFL;AAGJa,UAAAA,SAAS,EAAEhB,OAAO,CAAC,CAAD,CAAP,CAAWiB,IAHlB;AAIJE,UAAAA,MAAM,EAAEJ,GAAG,CAAC,QAAD,CAAH,GAAgB;AAJpB,SAAN;AAMAX,QAAAA,QAAQ,CAACgB,IAAT,CAAcN,GAAd;AACD;AACF,KAtBD;AAuBAO,IAAAA,OAAO,CAACC,GAAR,CAAYlB,QAAZ;AACD,GArCD,CAqCE,OAAOmB,KAAP,EAAc;AACdF,IAAAA,OAAO,CAACC,GAAR,CAAYC,KAAZ;AACD;;AAED,SAAO,MAAP;AACD,CA9CD;;AAgDA,SAASxB,kBAAT","sourcesContent":["import algosdk from \"algosdk\";\r\n\r\nconst port = \"\";\r\nconst CHOICE_ID = 21364625;\r\nconst baseServer = \"https://testnet-algorand.api.purestake.io/ps2\";\r\nconst indexerAddress = \"https://testnet-algorand.api.purestake.io/idx2\";\r\nconst token = { \"X-API-Key\": \"fi0QdbiBVl8hsVMCA2SUg6jnQdvAzxY48Zy2G6Yc\" };\r\n\r\nconst algodClient = new algosdk.Algodv2(token, baseServer, port);\r\n\r\nconst indexerClient = new algosdk.Indexer(token, indexerAddress, port);\r\n\r\nconst getCommittedAmount = async ({ options }) => {\r\n  const firstAddress = options[0].address;\r\n  const secondAddress = options[1].address;\r\n\r\n  try {\r\n    let txnArray = [];\r\n    let userAddress =\r\n      \"S76LPUPTSGL56BUGRKEQSWEDQ6VSMP62FPE3XJDREJ2XIDWQC36DL2KDJQ\";\r\n    let pastTxn = await indexerClient\r\n      .searchForTransactions()\r\n      .address(userAddress)\r\n      .assetID(CHOICE_ID)\r\n      .limit(20)\r\n      .do();\r\n\r\n    const txns = pastTxn[\"transactions\"];\r\n\r\n    txns.forEach((element) => {\r\n      let obj = {};\r\n      const txn = element[\"asset-transfer-transaction\"];\r\n\r\n      if (txn[\"receiver\"] == firstAddress) {\r\n        obj = {\r\n          candidate: options[0].name,\r\n          address: firstAddress,\r\n          Id: element[\"id\"],\r\n          amount: txn[\"amount\"] / 100,\r\n        };\r\n\r\n        txnArray.push(obj);\r\n      } else if (txn[\"receiver\"] == secondAddress) {\r\n        obj = {\r\n          Id: element[\"id\"],\r\n          address: secondAddress,\r\n          candidate: options[0].name,\r\n          amount: txn[\"amount\"] / 100,\r\n        };\r\n        txnArray.push(obj);\r\n      }\r\n    });\r\n    console.log(txnArray);\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n\r\n  return \"good\";\r\n};\r\n\r\nexport { getCommittedAmount };\r\n"]},"metadata":{},"sourceType":"module"}